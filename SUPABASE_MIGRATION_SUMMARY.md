# ‚úÖ Samkraft - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Supabase –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ó–∞–º–µ–Ω–∏–ª–∏ Cloudflare D1 –Ω–∞ Supabase PostgreSQL

**–ë—ã–ª–æ:** Cloudflare D1 (SQLite at edge)  
**–°—Ç–∞–ª–æ:** Supabase (PostgreSQL with superpowers)

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **PostgreSQL** - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î (–º–æ—â–Ω–µ–µ SQLite)  
‚úÖ **Built-in Auth** - JWT, OAuth, magic links –∏–∑ –∫–æ—Ä–æ–±–∫–∏  
‚úÖ **Real-time** - WebSocket subscriptions –¥–ª—è messaging  
‚úÖ **Storage** - –¥–ª—è PDF —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª–µ–π  
‚úÖ **Row-Level Security** - –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫  
‚úÖ **Auto-generated API** - REST endpoints —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **Dashboard** - —É–¥–æ–±–Ω—ã–π UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏  

### 3. –û–±–Ω–æ–≤–ª—ë–Ω –∫–æ–¥

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- ‚úÖ `src/index.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ API endpoints –¥–ª—è Supabase
- ‚úÖ `package.json` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å @supabase/supabase-js
- ‚úÖ `wrangler.jsonc` - —É–±—Ä–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è D1
- ‚úÖ `README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ë–î

**–§–∞–π–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã:**
- ‚úÖ `supabase_schema.sql` - –ø–æ–ª–Ω–∞—è SQL —Å—Ö–µ–º–∞ –¥–ª—è PostgreSQL (283 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `SUPABASE_DEPLOYMENT.md` - –ø–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥ –ø–æ –¥–µ–ø–ª–æ—é (479 —Å—Ç—Ä–æ–∫)
- ‚úÖ `QUICKSTART_SUPABASE.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (278 —Å—Ç—Ä–æ–∫)
- ‚úÖ `.dev.vars.example` - –ø—Ä–∏–º–µ—Ä env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ –ü–æ–ª–Ω—ã–π deployment guide —Å screenshots –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- ‚úÖ Quick start guide (5 –º–∏–Ω—É—Ç –¥–æ –¥–µ–ø–ª–æ—è)
- ‚úÖ Troubleshooting —Å–µ–∫—Ü–∏—è
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã SQL queries
- ‚úÖ RLS policies –ø—Ä–∏–º–µ—Ä—ã

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: D1 vs Supabase

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Cloudflare D1 | Supabase PostgreSQL |
|----------|---------------|---------------------|
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | SQLite | PostgreSQL ‚úÖ |
| **–ú–æ—â–Ω–æ—Å—Ç—å** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è | Full SQL support ‚úÖ |
| **Joins** | Limited | Full support ‚úÖ |
| **Transactions** | Basic | ACID compliant ‚úÖ |
| **Auth** | –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å | Built-in ‚úÖ |
| **Storage** | R2 (–æ—Ç–¥–µ–ª—å–Ω–æ) | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π ‚úÖ |
| **Real-time** | Durable Objects | Built-in ‚úÖ |
| **Dashboard** | Limited | Full-featured ‚úÖ |
| **Free tier** | 5GB | 500MB + 2GB storage |
| **Cost at scale** | ~$5/month | $0-25/month |

---

## üöÄ –ö–∞–∫ –¥–µ–ø–ª–æ–∏—Ç—å (Quick Version)

### –®–∞–≥ 1: Supabase (2 –º–∏–Ω—É—Ç—ã)
```bash
1. https://supabase.com/ ‚Üí New project
2. Copy: Project URL + anon key
3. SQL Editor ‚Üí Run supabase_schema.sql
```

### –®–∞–≥ 2: Cloudflare Pages (2 –º–∏–Ω—É—Ç—ã)
```bash
1. https://dash.cloudflare.com/
2. Pages ‚Üí Connect Git ‚Üí Samkraft
3. Build: npm run build ‚Üí dist
4. Environment variables:
   SUPABASE_URL = your-url
   SUPABASE_ANON_KEY = your-key
5. Deploy
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ (1 –º–∏–Ω—É—Ç–∞)
```bash
curl https://samkraft.pages.dev/api/health
# ‚úÖ "database": "Supabase PostgreSQL"

curl https://samkraft.pages.dev/api/municipalities  
# ‚úÖ –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 3 –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
```

**–ü–æ–ª–Ω—ã–π –≥–∞–π–¥:** [SUPABASE_DEPLOYMENT.md](SUPABASE_DEPLOYMENT.md)

---

## üìã –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –±—ã–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ D1:

### –í–∞—Ä–∏–∞–Ω—Ç A: –≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –≠–∫—Å–ø–æ—Ä—Ç –∏–∑ D1
npx wrangler d1 export samkraft-db --output data.sql

# 2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å SQLite ‚Üí PostgreSQL
# –ó–∞–º–µ–Ω–∏—Ç–µ:
# - INTEGER PRIMARY KEY AUTOINCREMENT ‚Üí UUID PRIMARY KEY DEFAULT uuid_generate_v4()
# - TEXT ‚Üí —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∏–ø (TEXT, VARCHAR, JSONB)
# - DATETIME ‚Üí TIMESTAMPTZ

# 3. –ò–º–ø–æ—Ä—Ç –≤ Supabase
# Supabase SQL Editor ‚Üí Run converted SQL
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ù–∞—á–∞—Ç—å —Å –Ω—É–ª—è (–ø—Ä–æ—â–µ)

```bash
# –°—É—Ç—å:
- Seed data —É–∂–µ –µ—Å—Ç—å –≤ supabase_schema.sql
- –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–¥—É—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

## ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### 1. Authentication (Phase 1 - —Å–ª–µ–¥—É—é—â–∏–µ 2 –Ω–µ–¥–µ–ª–∏)

```typescript
import { createClient } from '@supabase/supabase-js'

const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
const { data, error } = await supabase.auth.signUp({
  email: 'user@example.com',
  password: 'secure_password'
})

// –õ–æ–≥–∏–Ω
const { data, error } = await supabase.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'secure_password'
})

// Magic link (–±–µ–∑ –ø–∞—Ä–æ–ª—è!)
const { data, error } = await supabase.auth.signInWithOtp({
  email: 'user@example.com'
})
```

### 2. Real-time subscriptions (Phase 2)

```typescript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
supabase
  .channel('public:projects')
  .on('postgres_changes', { 
    event: 'INSERT', 
    schema: 'public', 
    table: 'projects' 
  }, (payload) => {
    console.log('–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç!', payload.new)
    // –û–±–Ω–æ–≤–∏—Ç—å UI
  })
  .subscribe()

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
supabase
  .channel('messages')
  .on('postgres_changes', { 
    event: 'INSERT', 
    schema: 'public', 
    table: 'messages',
    filter: `recipient_id=eq.${userId}`
  }, (payload) => {
    console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!', payload.new)
    showNotification(payload.new.body)
  })
  .subscribe()
```

### 3. File Storage (Phase 2)

```typescript
// Upload —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (PDF)
const { data, error } = await supabase.storage
  .from('certificates')
  .upload('certificate_abc123.pdf', pdfBlob, {
    cacheControl: '3600',
    upsert: false
  })

// –ü–æ–ª—É—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π URL
const { data } = supabase.storage
  .from('certificates')
  .getPublicUrl('certificate_abc123.pdf')

console.log(data.publicUrl)
// https://xxx.supabase.co/storage/v1/object/public/certificates/certificate_abc123.pdf
```

### 4. Row-Level Security (–∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö)

```sql
-- –ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
CREATE POLICY "Users can view their own messages"
  ON messages
  FOR SELECT
  USING (
    sender_id = auth.uid() 
    OR 
    recipient_id = auth.uid()
  );

-- –ü—Ä–∏–º–µ—Ä: —Ç–æ–ª—å–∫–æ creator –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
CREATE POLICY "Creators can update their projects"
  ON projects
  FOR UPDATE
  USING (creator_id = auth.uid());
```

---

## üìà –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Roadmap)

### ‚úÖ –°–¥–µ–ª–∞–Ω–æ
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Supabase
- [x] SQL schema
- [x] API endpoints
- [x] Deployment guide
- [x] Quick start guide

### ‚è≥ Phase 1 (Next 2-3 weeks)
- [ ] Supabase Auth integration
- [ ] User registration (no personnummer)
- [ ] Login/logout
- [ ] Protected routes
- [ ] JWT tokens

### ‚è≥ Phase 2 (Month 2)
- [ ] Project creation (authenticated users)
- [ ] Application system
- [ ] Real-time notifications
- [ ] Messaging system
- [ ] File uploads (profile photos)

### ‚è≥ Phase 3 (Month 3)
- [ ] PDF certificates generation
- [ ] Certificate storage (Supabase Storage)
- [ ] QR code verification
- [ ] Recommendation letters
- [ ] Municipality dashboard

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

### Supabase Free Tier (—Ç–µ–∫—É—â–∏–π)
- ‚úÖ 500MB Database
- ‚úÖ 2GB Storage
- ‚úÖ 50,000 monthly active users
- ‚úÖ 500MB Egress
- ‚úÖ Unlimited API requests

**–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è:**
- 500-1,000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- 10,000+ –ø—Ä–æ–µ–∫—Ç–æ–≤
- 50,000+ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã

### –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω Supabase Pro ($25/month)?
- >500MB –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
- >50k monthly active users
- –ù—É–∂–Ω–∞ prioritized support
- –ù—É–∂–µ–Ω custom domain email

### Cloudflare Pages (–ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- ‚úÖ Unlimited static requests
- ‚úÖ Unlimited bandwidth
- ‚úÖ 500 builds/month

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

**–ü—Ä–æ–µ–∫—Ç:**
- GitHub: https://github.com/OummaEE/Samkraft
- Issues: https://github.com/OummaEE/Samkraft/issues

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [SUPABASE_DEPLOYMENT.md](SUPABASE_DEPLOYMENT.md) - –ü–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥
- [QUICKSTART_SUPABASE.md](QUICKSTART_SUPABASE.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [README.md](README.md) - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [API_EXAMPLES.md](API_EXAMPLES.md) - API –ø—Ä–∏–º–µ—Ä—ã

**External:**
- Supabase Docs: https://supabase.com/docs
- Cloudflare Docs: https://developers.cloudflare.com/pages/
- Hono Docs: https://hono.dev/

---

## üéâ –ò—Ç–æ–≥

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **READY TO DEPLOY**

**–ß—Ç–æ –ø–æ–ª—É—á–∏–ª–∏:**
- üí™ –ë–æ–ª–µ–µ –º–æ—â–Ω–∞—è –ë–î (PostgreSQL)
- üîê Authentication –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚ö° Real-time capabilities
- üì¶ File storage
- üõ°Ô∏è Row-Level Security
- üìä –õ—É—á—à–∏–π dashboard
- üìà –ë–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è scale

**–í—Ä–µ–º—è –¥–æ production:** ~10 –º–∏–Ω—É—Ç (—Å–ª–µ–¥—É–π—Ç–µ SUPABASE_DEPLOYMENT.md)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –Ω–∞ Cloudflare Pages —Å Supabase!

---

*Made with ‚ù§Ô∏è for integration and social cohesion in Sweden*  
*Powered by Supabase PostgreSQL üêò*
