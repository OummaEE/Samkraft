# üöÄ –®–∞–≥–∏ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Samkraft —Å Supabase

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ Supabase –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω
2. ‚úÖ Credentials –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.dev.vars`
3. ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Supabase

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–í–ê–ñ–ù–û!)

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é –≤ Supabase

**–≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ! –ë–µ–∑ —ç—Ç–æ–≥–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –ø—É—Å—Ç–æ–π.**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à Supabase –ø—Ä–æ–µ–∫—Ç:
   ```
   https://app.supabase.com/project/dltfprkqyzxyyvfejrdy
   ```

2. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **SQL Editor**

3. –ù–∞–∂–º–∏—Ç–µ **New query**

4. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `supabase_schema.sql` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitHub:
   ```
   https://github.com/OummaEE/Samkraft/blob/main/supabase_schema.sql
   ```

5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ** —Ñ–∞–π–ª–∞ (283 —Å—Ç—Ä–æ–∫–∏ SQL)

6. **–í—Å—Ç–∞–≤—å—Ç–µ** –≤ SQL Editor –≤ Supabase

7. –ù–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ Ctrl/Cmd + Enter)

8. –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∑–∞–π–º—ë—Ç ~5-10 —Å–µ–∫—É–Ω–¥)

9. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   Success. No rows returned
   NOTICE: Samkraft database schema created successfully!
   NOTICE: Next steps:
   NOTICE: 1. Configure RLS policies for authenticated users
   NOTICE: 2. Set up Supabase Auth
   NOTICE: 3. Update your app environment variables
   ```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã

1. –í Supabase –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor** (–ª–µ–≤–æ–µ –º–µ–Ω—é)

2. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å **12 —Ç–∞–±–ª–∏—Ü**:
   - ‚úÖ users
   - ‚úÖ projects
   - ‚úÖ project_roles
   - ‚úÖ project_participants
   - ‚úÖ skills
   - ‚úÖ user_skills
   - ‚úÖ certificates
   - ‚úÖ recommendations
   - ‚úÖ messages
   - ‚úÖ municipalities
   - ‚úÖ activity_log

3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **skills** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **10 –∑–∞–ø–∏—Å–µ–π** (seed data)

4. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **municipalities** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **3 –∑–∞–ø–∏—Å–∏**

‚úÖ –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ - **–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞!**

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd /home/user/webapp

# 1. –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
npm run build

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
npx wrangler pages dev dist --port 3000
```

### –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```
http://localhost:3000
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API

```bash
# Health check
curl http://localhost:3000/api/health

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:
{
  "status": "ok",
  "timestamp": "...",
  "service": "Samkraft API",
  "database": "Supabase PostgreSQL"
}

# Municipalities
curl http://localhost:3000/api/municipalities

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 3 –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
```

---

## ‚òÅÔ∏è –î–µ–ø–ª–æ–π –Ω–∞ Cloudflare Pages

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ GitHub (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ö–æ–¥ —É–∂–µ –Ω–∞ GitHub: https://github.com/OummaEE/Samkraft

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Cloudflare Dashboard:
   ```
   https://dash.cloudflare.com/
   ```

3. **Workers & Pages** ‚Üí **Create application** ‚Üí **Pages** ‚Üí **Connect to Git**

4. –í—ã–±–µ—Ä–∏—Ç–µ **GitHub** –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ Cloudflare

5. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π **Samkraft**

6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ build:
   - **Project name:** `samkraft`
   - **Production branch:** `main`
   - **Build command:** `npm run build`
   - **Build output directory:** `dist`

7. –ù–∞–∂–º–∏—Ç–µ **Save and Deploy**

8. **–í–ê–ñ–ù–û:** –î–æ–±–∞–≤—å—Ç–µ Environment Variables:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Environment variables**
   - **Production** (–∏ Preview –µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
     
     **Variable 1:**
     - Name: `SUPABASE_URL`
     - Value: `https://dltfprkqyzxyyvfejrdy.supabase.co`
     
     **Variable 2:**
     - Name: `SUPABASE_ANON_KEY`
     - Value: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsdGZwcmtxeXp4eXl2ZmVqcmR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NzcxNDksImV4cCI6MjA4NjU1MzE0OX0.EpSsjOtnxkgKw32VdjMZl62ug59_tYB9APtKveyMAH4`

9. **Save**

10. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ **Deployments** ‚Üí **Retry deployment** (—á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å env variables)

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ CLI

```bash
cd /home/user/webapp

# 1. –î–µ–ø–ª–æ–π
npx wrangler pages deploy dist --project-name samkraft

# 2. –î–æ–±–∞–≤–∏—Ç—å env variables —á–µ—Ä–µ–∑ dashboard (—Å–º. –≤—ã—à–µ –í–∞—Ä–∏–∞–Ω—Ç A, —à–∞–≥ 8)
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ production deployment

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

```bash
# –ü–æ–ª—É—á–∏—Ç–µ URL (–±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ https://samkraft.pages.dev)

# Health check
curl https://samkraft.pages.dev/api/health

# Municipalities
curl https://samkraft.pages.dev/api/municipalities

# Skills
curl https://samkraft.pages.dev/api/skills
```

---

## üìä –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

### –ß–µ—Ä–µ–∑ Supabase Dashboard

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor** ‚Üí **projects**

2. –ù–∞–∂–º–∏—Ç–µ **Insert** ‚Üí **Insert row**

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   ```
   title: Community Garden in J√§rva
   description_short: Build a community garden together
   description_long: We will create a 200m¬≤ community garden where local residents can grow vegetables and meet neighbors.
   category_primary: environmental
   location_municipality: Stockholms kommun
   status: active
   visibility: public
   max_participants: 15
   start_date: 2026-06-01
   end_date: 2026-09-30
   weekly_commitment: 4-6 hours/week
   ```

4. **Save**

5. –û–±–Ω–æ–≤–∏—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É - –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è!

### –ß–µ—Ä–µ–∑ SQL

```sql
INSERT INTO projects (
  title,
  description_short,
  description_long,
  category_primary,
  location_municipality,
  status,
  visibility,
  max_participants,
  start_date,
  end_date,
  weekly_commitment
) VALUES (
  'Community Garden in J√§rva',
  'Build a community garden together',
  'We will create a 200m¬≤ community garden where local residents can grow vegetables and meet neighbors.',
  'environmental',
  'Stockholms kommun',
  'active',
  'public',
  15,
  '2026-06-01',
  '2026-09-30',
  '4-6 hours/week'
);
```

---

## üéØ Checklist

- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ Supabase
- [ ] 12 —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–Ω—ã
- [ ] Seed data (skills, municipalities) –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- [ ] –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ
- [ ] –î–µ–ø–ª–æ–π –Ω–∞ Cloudflare Pages –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Environment variables –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] Production API —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–æ–±–∞–≤–ª–µ–Ω —Ö–æ—Ç—è –±—ã 1 —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
- [ ] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

---

## ‚ùì Troubleshooting

### "Database connection failed"

**–ü—Ä–∏—á–∏–Ω–∞:** Environment variables –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ Cloudflare

**–†–µ—à–µ–Ω–∏–µ:**
1. Cloudflare Pages ‚Üí Settings ‚Üí Environment variables
2. –î–æ–±–∞–≤—å—Ç–µ `SUPABASE_URL` –∏ `SUPABASE_ANON_KEY`
3. Retry deployment

### "Failed to fetch projects"

**–ü—Ä–∏—á–∏–Ω–∞:** SQL –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. Supabase ‚Üí SQL Editor
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `supabase_schema.sql`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Table Editor ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 12 —Ç–∞–±–ª–∏—Ü

### –ü—Ä–æ–µ–∫—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–æ `status='active'`

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç (—Å–º. –≤—ã—à–µ)
2. –£–±–µ–¥–∏—Ç–µ—Å—å: `status='active'` –∏ `visibility='public'`

---

## üìö –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. ‚è≥ **Phase 1: Authentication** (2-3 –Ω–µ–¥–µ–ª–∏)
   - Supabase Auth integration
   - User registration (no personnummer)
   - Login/logout
   - Protected routes

2. ‚è≥ **Phase 2: CRUD** (1 –º–µ—Å—è—Ü)
   - Project creation
   - Application system
   - Hours tracking
   - Real-time notifications

3. ‚è≥ **Phase 3: Certificates** (1 –º–µ—Å—è—Ü)
   - PDF generation
   - QR verification
   - Recommendation letters
   - Municipality dashboard

---

**–í–∞—à–∏ credentials –±–µ–∑–æ–ø–∞—Å–Ω—ã:**
- ‚úÖ `.dev.vars` –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
- ‚úÖ Anon key –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è client-side
- ‚úÖ Row-Level Security –∑–∞—â–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ! üéâ**

Repository: https://github.com/OummaEE/Samkraft  
Supabase Project: https://app.supabase.com/project/dltfprkqyzxyyvfejrdy
